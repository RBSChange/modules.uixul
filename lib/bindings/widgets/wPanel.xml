<?xml version="1.0"?>
<bindings
	xmlns="http://www.mozilla.org/xbl"
	xmlns:xul="http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul">

<!--
wPanel
	@author INTbonjF
	@date   2006-04-19
-->
	<binding id="wPanel" extends="widgets.wWidget#wWidget">

		<implementation>

			<field name="isawpanel">true</field>

			<method name="hide">
				<body><![CDATA[
					this.setAttribute('collapsed', 'true');
					this.hideContainer();
				]]></body>
			</method>

			<method name="show">
				<parameter name="force" />
				<body><![CDATA[
					if (this.hasAttribute('collapsed'))
					{
						this.removeAttribute('collapsed');
						this.showContainer();
						if ("handleBroadcast" in this)
						{
							this.handleBroadcast();
						}
					}
					else if (force && ("handleBroadcast" in this))
					{
						this.handleBroadcast();
					}					
				]]></body>
			</method>

			<method name="hideContainer">
				<body><![CDATA[
					var panelContainer = this.parentNode;
					if (panelContainer.getAttribute('name') != 'panelContainer')
					{
						return;
					}
					for (var i=0 ; i<panelContainer.childNodes.length ; i++)
					{
						var child = panelContainer.childNodes[i];
						if (child.isawpanel && !child.hasAttribute('collapsed'))
						{
							return;
						}
					}
					panelContainer.setAttribute('collapsed', 'true');
					if (panelContainer.previousSibling.tagName == 'splitter')
					{
						panelContainer.previousSibling.setAttribute('collapsed', 'true');
					}
				]]></body>
			</method>


			<method name="showContainer">
				<body><![CDATA[
					var panelContainer = this.parentNode;
					if (panelContainer.getAttribute('name') != 'panelContainer')
					{
						return;
					}
					panelContainer.removeAttribute('collapsed');
					if (panelContainer.previousSibling.tagName == 'splitter') //  && this.isTree()
					{
						panelContainer.previousSibling.removeAttribute('collapsed');
					}
				]]></body>
			</method>


			<method name="submit">
				<body><![CDATA[
				]]></body>
			</method>

		</implementation>

		<handlers>

			<handler event="keypress" keycode="VK_ESCAPE" phase="capturing" preventdefault="true"><![CDATA[
				this.hide();
			]]></handler>


			<handler event="keypress" key="s" phase="capturing" preventdefault="true" modifiers="control"><![CDATA[
				this.submit();
			]]></handler>


			<handler event="keypress" keycode="VK_RETURN" phase="capturing" preventdefault="true" modifiers="control"><![CDATA[
				this.submit();
			]]></handler>

		</handlers>

    </binding>


	<binding id="wPanelHeader">

		<implementation>

			<property name="image">
				<getter>
					return document.getAnonymousElementByAttribute(this, "anonid", "image");
				</getter>
			</property>

			<property name="label">
				<getter>
					return document.getAnonymousElementByAttribute(this, "anonid", "label");
				</getter>
			</property>

		</implementation>

		<xbl:content
			xmlns="http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul"
			xmlns:xbl="http://www.mozilla.org/xbl">
			<toolbox flex="1" class="change-toolbox">
				<toolbar class="panelheader" flex="1" align="center">
					<image anonid="image" xbl:inherits="src=icon" />
					<label anonid="label" xbl:inherits="value=label" flex="1" crop="center" />
					<spacer flex="1" />
					<whelp xbl:inherits="text=helptext" />
					<toolbarbutton oncommand="hide()" image="{IconsBase}/small/shadow/error.png" tooltiptext="&amp;modules.uixul.bo.general.buttons.Close;" class="neutral" />
				</toolbar>
			</toolbox>
		</xbl:content>

	</binding>

</bindings>
