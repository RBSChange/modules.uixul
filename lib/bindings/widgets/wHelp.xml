<?xml version="1.0"?>
<bindings
	xmlns="http://www.mozilla.org/xbl"
	xmlns:xul="http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul">

<!--
################################################################################
## wHelp                                                                      ##
################################################################################
-->

	<binding id="wHelp">

		<implementation>

		    <field name="_moreHelp" readonly="false"><![CDATA[
                undefined
             ]]></field>

			<constructor><![CDATA[
				var parentId = '';
				if (this.parentNode.id)
				{
					parentId = this.parentNode.id;
				}
				else if (this.parentNode.name)
				{
					parentId = this.parentNode.name;
				}
				else
				{
					parentId = this.parentNode.tagName;
				}

				var moreHelp = ownerDocument.getAnonymousElementByAttribute(this, "anonid", "moreHelp");
				if (this.hasAttribute('more') && this.getAttribute('more').length)
				{
				    moreHelp.removeAttribute('collapsed');
				    this._moreHelp = this.getAttribute('more');
				}
				else
				{
				    var image = ownerDocument.getAnonymousElementByAttribute(this, "anonid", "image");
    				if (this.hasAttribute('text') && this.getAttribute('text').length)
    				{
    					image.removeAttribute('hidden');
    				}
    				var tip   = ownerDocument.getAnonymousElementByAttribute(this, "anonid", "tip");
    				var tipId = 'wHelp-tip-' + parentId + '-' + Math.random();
    				tip.setAttribute('id', tipId);
				image.setAttribute('tooltip', tipId);
    		    }
			]]></constructor>

			<method name="moreHelp">
				<body><![CDATA[
					try
                    {
                        wToolkit.dialog('uixul', 'MoreHelp', {message: this._moreHelp}, {height: 155, chrome: 'yes', dialog: 'yes', titlebar: 'no', close: 'no'}, false, true);
    				}
    				catch (e)
                    {
                        wCore.error("wHelp.moreHelp", [], e);
                    }
                ]]></body>
			</method>

		</implementation>

		<xbl:content
			xmlns="http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul"
			xmlns:xbl="http://www.mozilla.org/xbl">
			<hbox align="center">
    			<image anonid="image" hidden="true" src="{IconsBase}/small/shadow/help2.png" style="cursor: help" />
    			<tooltip anonid="tip" orient="vertical">
    				<description xbl:inherits="value=text" maxwidth="100"/>
    			</tooltip>
    			<toolbarbutton anonid="moreHelp" collapsed="true" image="{IconsBase}/small/shadow/help2.png" style="cursor: help" tooltiptext="&amp;modules.uixul.bo.general.More-help-tooltip;" oncommand="moreHelp()" />
    	   </hbox>
		</xbl:content>

	</binding>

</bindings>