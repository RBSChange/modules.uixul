<?xml version="1.0" encoding="UTF-8"?>
<bindings
	xmlns="http://www.mozilla.org/xbl"
	xmlns:xul="http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul">
	
    <binding id="cEmptyBlock" extends="layout.cBlockBase#cBlockBase">
		<implementation>
			<method name="initialize">
				<body><![CDATA[
					this.setBlockType(this.getAttribute('type'));
					if (this.hasAttribute("absoluteFrontofficeHeight"))
					{
						this.setContentHeight(this.getAttribute("absoluteFrontofficeHeight")+'px');
					}
					this.setParametersFromDisplayString(this.getAttribute('displayString'));
					this.getParentLayoutElement().resizeBlocks();
    			]]></body>
			</method>
			
			<method name="resize">
				<parameter name="widthInPixels" />
				<parameter name="heightInPixels" />
				<body><![CDATA[
					var width = (widthInPixels)+'px';
					var height = heightInPixels+'px';
					var contentWidth = (widthInPixels-this.getOffset())+'px';
            		var container = this;
            		if (heightInPixels != undefined)
            		{
            			this.style.height = height;
    					this.style.maxHeight = height;
    					this.style.minHeight = height;
    					
    				}
    				if (widthInPixels != undefined)
            		{
            			this.style.width = width;
    					this.style.maxWidth = width;
    					this.style.minWidth = width;
    					var toResize = this.getElementById("container");
    					{
    						toResize.style.width = contentWidth
    						toResize.style.maxWidth = contentWidth;
    						toResize.style.minWidth = contentWidth;
    					}
    				}			
            	]]></body>
			</method>
			
			<method name="setContentHeight">
				<parameter name="valueInPx"/>
				<body><![CDATA[
					this.style.height = valueInPx;
					this.setAttribute("height", this.style.height);
				]]></body>
			</method>
			
			<method name="getContentHeight">
				<body><![CDATA[
					if (this.style.height != undefined)
					{
						return this.style.height;
					}
					return null;
				]]></body>
			</method>
			
			<method name="getContentHeightAsInt">
				<body><![CDATA[
					var widthString = this.getContentHeight();
					if (widthString != undefined)
					{
						return parseInt(widthString.substring(0, widthString.lastIndexOf("px")));
					}
					return null;
				]]></body>
			</method>
			
			<method name="getOffset">
				<body><![CDATA[
					return this.getRightDropZone().collapsed ? 7 : 15;
				]]></body>
			</method>
			
			<method name="getContentWidth">
				<body><![CDATA[
					if (this.style.width != undefined)
					{
						return this.style.width;
					}
					return null;
				]]></body>
			</method>
			
			<method name="getXMLContent">
				<body><![CDATA[
					var node = document.createElementNS("http://www.rbs.fr/change/1.0/schema", "change:spacer");					
					if (this.getContentHeight() != undefined)
					{
						node.setAttribute("__height", this.getContentHeight());
						node.setAttribute("height", this.getContentHeight());
						node.setAttribute("absoluteFrontofficeHeight", this.getContentHeightAsInt());
					}
					if (this.getContentWidth() != undefined)
					{
						node.setAttribute("width", this.getContentWidth());
						node.setAttribute("contentWidth",this.getContentWidth());
					}
					
					if (this.hasAttribute("blockwidth"))
					{
						node.setAttribute("blockwidth", this.getAttribute("blockwidth"));
						node.setAttribute("absoluteFrontofficeWidth", this.getAttribute("blockwidth"));
						node.setAttribute("width", this.getAttribute("blockwidth")+'px');
					}
					else
					{
						node.setAttribute("relativeFrontofficeWidth", Math.floor(this.getWidthAsInt()/this.parentNode.boxObject.width*100.0));
					}
					return node;
				]]></body>
			</method>
			
			<method name="postInsert">
				<parameter name="parameters"/>
				<body><![CDATA[
					if (parameters['type'] == 'left')
					{
						this.hideRightDropZone();	
					}
					else
					{
					}
					if (this.hasAttribute("blockwidth"))
					{
						this.assignedWidthInPixels = parseInt(this.getAttribute("blockwidth"));
					}
					this.getParentLayoutElement().resizeBlocks();
				]]></body>
			</method>
			
			<method name="setDefaultContent">
				<body><![CDATA[
				]]></body>
			</method>
		</implementation>
    	</binding>
    		<content
			xmlns="http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul">
			<cdropzone anonid="leftDropZone" type="left" />
			<box anonid="container">
				 
			</box>
			<cdropzone anonid="rightDropZone" type="right" />
		</content>
</bindings>